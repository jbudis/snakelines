rule infer_read_groups:
    input:
        '{path}/{sample}.bam'
    output:
        '{path}/{sample}.rg.bam'
    params:
        infer_script = srcdir("scripts/infer_read_groups.py")
    shell:
        '''
        samtools view \
            -h \
            {input} \
        | {params.infer_script} \
            {wildcards.sample} \
            - \
        | samtools view \
            -bS \
        > {output}
        '''
