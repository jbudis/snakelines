Metaxa2 - Classify Reads
----------------------------

Find closest homologue sequence for each sequenced fragment

**Location**

- *Filepath:* <SnakeLines_dir>/rules/classification/read_based/metaxa2.snake
- *Rule name:* metaxa2__classify_reads

**Input(s):**

- *r1:* Left side of sequenced fragments in gzipped fastq format
- *r2:* Right side of sequenced fragments in gzipped fastq format
- *blast:* Blast index of reference sequences (generated by Metaxa2 database builder)
- *cutoffs:* Auxiliary files from reference sequences (generated by Metaxa2 database builder)
- *hmm:* Auxiliary file from reference sequences (generated by Metaxa2 database builder)

**Output(s):**

- *taxonomy:* Summary taxonomies of classified sequenced fragments

Metaxa2 - Create Reference Index
------------------------------------

Transform genomic sequences into Metaxa2 index for faster classification

**Location**

- *Filepath:* <SnakeLines_dir>/rules/classification/read_based/metaxa2.snake
- *Rule name:* metaxa2__create_reference_index

**Input(s):**

- *fasta:* Genomic reference sequences in Fasta format
- *tax:* Taxonomies for each reference sequence

**Output(s):**

- *blast:* Blast index of reference sequences
- *cutoffs:* Auxiliary files from reference sequences
- *hmm:* Auxiliary file from reference sequences

Metaxa2 - Summarize Classification
--------------------------------------

Summarize taxonomies per individual taxonomic levels - e.g. for species, order ...

**Location**

- *Filepath:* <SnakeLines_dir>/rules/classification/read_based/metaxa2.snake
- *Rule name:* metaxa2__summarize_classification

**Input(s):**

- *taxonomy:* Classified fragments - output of metaxa2 tool
- *nomatch_template:* Auxiliary file for margin case without any classified fragment
- *nomatch_tax_template:* Auxiliary file for margin case without any classified fragment

**Output(s):**

- *summary:* Summarized taxonomy per species level (others should be generated accordingly)

Metaxa2 - Prepare For Krona
-------------------------------

Convert metaxa2 classification files into standardised format suitable for generation of Krona reports

**Location**

- *Filepath:* <SnakeLines_dir>/rules/classification/read_based/metaxa2.snake
- *Rule name:* metaxa2__prepare_for_krona

**Input(s):**

- *classification:* Summarized classification from Metaxa2 classifier

**Output(s):**

- *krona:* Tabular format suitable for Krona report generation

