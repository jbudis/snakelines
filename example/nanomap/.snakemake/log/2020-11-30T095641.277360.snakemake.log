Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	2	clair__variant_call_mapped_reads
	1	pipeline
	2	samtools__convert_sam_to_bam
	2	samtools__sort_bam_by_position
	7

[Mon Nov 30 09:56:41 2020]
rule samtools__convert_sam_to_bam:
    input: mapping/sars_cov_2/original/example_2.sam
    output: mapping/sars_cov_2/original/example_2.bam
    jobid: 11
    reason: Missing output files: mapping/sars_cov_2/original/example_2.bam
    wildcards: path=mapping/sars_cov_2/original, sample=example_2


        samtools view -S -b mapping/sars_cov_2/original/example_2.sam > mapping/sars_cov_2/original/example_2.bam
        

[Mon Nov 30 09:56:41 2020]
rule samtools__convert_sam_to_bam:
    input: mapping/sars_cov_2/original/example_1.sam
    output: mapping/sars_cov_2/original/example_1.bam
    jobid: 10
    reason: Missing output files: mapping/sars_cov_2/original/example_1.bam; Updated input files: mapping/sars_cov_2/original/example_1.sam
    wildcards: path=mapping/sars_cov_2/original, sample=example_1


        samtools view -S -b mapping/sars_cov_2/original/example_1.sam > mapping/sars_cov_2/original/example_1.bam
        
Activating conda environment: /home/adog/snakelines/example/nanomap/aef0721a
Activating conda environment: /home/adog/snakelines/example/nanomap/aef0721a
[Mon Nov 30 09:56:43 2020]
Finished job 10.
1 of 7 steps (14%) done
[Mon Nov 30 09:56:43 2020]
Finished job 11.
2 of 7 steps (29%) done

[Mon Nov 30 09:56:43 2020]
rule samtools__sort_bam_by_position:
    input: mapping/sars_cov_2/original/example_2.bam
    output: mapping/sars_cov_2/original/example_2_sorted.bam
    jobid: 9
    reason: Missing output files: mapping/sars_cov_2/original/example_2_sorted.bam; Input files updated by another job: mapping/sars_cov_2/original/example_2.bam
    wildcards: path=mapping/sars_cov_2/original, sample=example_2


        samtools sort mapping/sars_cov_2/original/example_2.bam > mapping/sars_cov_2/original/example_2_sorted.bam
        

[Mon Nov 30 09:56:43 2020]
rule samtools__sort_bam_by_position:
    input: mapping/sars_cov_2/original/example_1.bam
    output: mapping/sars_cov_2/original/example_1_sorted.bam
    jobid: 8
    reason: Missing output files: mapping/sars_cov_2/original/example_1_sorted.bam; Input files updated by another job: mapping/sars_cov_2/original/example_1.bam
    wildcards: path=mapping/sars_cov_2/original, sample=example_1


        samtools sort mapping/sars_cov_2/original/example_1.bam > mapping/sars_cov_2/original/example_1_sorted.bam
        
Activating conda environment: /home/adog/snakelines/example/nanomap/aef0721a
Activating conda environment: /home/adog/snakelines/example/nanomap/aef0721a
[Mon Nov 30 09:56:44 2020]
Finished job 9.
3 of 7 steps (43%) done
[Mon Nov 30 09:56:44 2020]
Finished job 8.
4 of 7 steps (57%) done

[Mon Nov 30 09:56:44 2020]
rule clair__variant_call_mapped_reads:
    input: mapping/sars_cov_2/original/example_1_sorted.bam, reference/sars_cov_2/sars_cov_2.fa, reference/sars_cov_2/sars_cov_2.fa.fai
    output: variant/sars_cov_2/original/example_1/
    log: variant/sars_cov_2/original/log/example_1.log, variant/sars_cov_2/original/log/example_1.err
    jobid: 6
    reason: Input files updated by another job: mapping/sars_cov_2/original/example_1_sorted.bam
    wildcards: reference=sars_cov_2, map_type=original, sample=example_1
    threads: 10


        python3 $CLAIR callVarBamParallel             --chkpnt_fn ~/Clair/models/ont/model/model             --ref_fn reference/sars_cov_2/sars_cov_2.fa             --bam_fn mapping/sars_cov_2/original/example_1_sorted.bam             --includingAllContigs             --output_prefix variant/sars_cov_2/original/example_1/var > command.sh

        cat command.sh | parallel -j10 --will-cite

        for i in variant/sars_cov_2/original/example_1/*.vcf
        do
            if ! [ -z "$(tail -c 1 "$i")" ]; then echo "$i"; fi
        done | grep -f - command.sh | sh
        
        vcfcat variant/sars_cov_2/original/example_1//*.vcf | bcftools sort | bgziptabix variant/sars_cov_2/original/example_1//all.vcf
        
Skipped removing non-empty directory variant/sars_cov_2/original/example_1/
Activating conda environment: /home/adog/snakelines/example/nanomap/1d042689
[Mon Nov 30 09:57:11 2020]
Error in rule clair__variant_call_mapped_reads:
    jobid: 6
    output: variant/sars_cov_2/original/example_1/
    log: variant/sars_cov_2/original/log/example_1.log, variant/sars_cov_2/original/log/example_1.err (check log file(s) for error message)
    conda-env: /home/adog/snakelines/example/nanomap/1d042689
    shell:
        
        python3 $CLAIR callVarBamParallel             --chkpnt_fn ~/Clair/models/ont/model/model             --ref_fn reference/sars_cov_2/sars_cov_2.fa             --bam_fn mapping/sars_cov_2/original/example_1_sorted.bam             --includingAllContigs             --output_prefix variant/sars_cov_2/original/example_1/var > command.sh

        cat command.sh | parallel -j10 --will-cite

        for i in variant/sars_cov_2/original/example_1/*.vcf
        do
            if ! [ -z "$(tail -c 1 "$i")" ]; then echo "$i"; fi
        done | grep -f - command.sh | sh
        
        vcfcat variant/sars_cov_2/original/example_1//*.vcf | bcftools sort | bgziptabix variant/sars_cov_2/original/example_1//all.vcf
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job clair__variant_call_mapped_reads since they might be corrupted:
variant/sars_cov_2/original/example_1/
Skipped removing non-empty directory variant/sars_cov_2/original/example_1/
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /home/adog/snakelines/example/nanomap/.snakemake/log/2020-11-30T095641.277360.snakemake.log
